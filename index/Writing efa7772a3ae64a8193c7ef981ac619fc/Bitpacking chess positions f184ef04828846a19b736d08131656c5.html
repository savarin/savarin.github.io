<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Bitpacking chess positions</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="f184ef04-8288-46a1-9b73-6d08131656c5" class="page sans"><header><h1 class="page-title">Bitpacking chess positions</h1></header><div class="page-body"><p id="1643d997-ad6a-4b94-9f04-7a7538c67132" class=""><em>Author&#x27;s note: This post was adapted from a presentation at the </em><a href="https://www.recurse.com"><em>Recurse Center</em></a><em>.</em></p><p id="09f30c34-6d36-48b4-9af7-18982d4270d5" class="">
</p><p id="74b66c5e-b311-4090-b4e0-997f3a19299e" class="">This excursion started with <a href="https://sr.ht/~ntietz">Nicholas Tietz-Sokolsky</a>’s <a href="https://ntietz.com/blog/rc-week-8-recap">blog post</a>.</p><figure id="a2cc38bd-6b2d-47b7-8ecc-355b39d83226" class="image"><a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled.png"><img style="width:3738px" src="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled.png"/></a></figure><p id="9edf55d4-f994-426e-81c4-4da91b2098ce" class="">
</p><p id="28c4bef3-db3e-46bd-a4d1-eaee2d7accfd" class="">I couldn’t help but wonder - is this really the case?</p><h1 id="cf31153f-d882-46ba-aa83-75b53d1361de" class="">Easy mode</h1><p id="afb75ab3-83d1-4d09-b4f1-3bdacb645947" class="">There are 32 pieces on a chess board. Here we line them up side-by-side.</p><figure id="39c8878a-3dd6-4ed5-a271-26eaf63a56a2" class="image"><a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%201.png"><img style="width:3738px" src="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%201.png"/></a></figure><p id="5fe4328d-a444-4c22-ab15-c582d92f85bb" class="">
</p><p id="49a94aef-8272-4037-8d81-d60b7b83b20a" class="">Each piece can occupy one of 64 squares. Let’s denote each piece by a number between 0 and 63 to represent the respective square.</p><figure id="74709ccd-e8ba-4c19-8aa0-f8f6bb684bc7" class="image"><a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%202.png"><img style="width:3738px" src="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%202.png"/></a></figure><p id="c267c658-efaa-4626-bf3c-9262a73cdeb5" class="">
</p><p id="c73afd61-a0a6-43a0-9ba3-65cb89e545b5" class="">Since each position takes up 6 bits (<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>6</mn></msup><mo>=</mo><mn>64</mn></mrow><annotation encoding="application/x-tex">2^6 = 64</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">64</span></span></span></span></span><span>﻿</span></span>), multiplying 6 bits by 32 pieces gives us 192 bits / <strong>24 bytes</strong> (1 byte = 8 bits).</p><h1 id="c1663d77-6626-4894-b583-e260c88ba4d2" class="">Not so fast</h1><p id="51e681fa-17eb-4f7e-9e21-54fe2e4d42fd" class="">Of course, it’s rarely that simple <a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5.html">[1]</a>.</p><h3 id="9a76ddf2-b9ee-44e6-8dc0-7789376851b5" class="">Captures</h3><p id="e49f5c3b-9b2c-4765-bdd0-c5dca3413e87" class="">In addition to positions, we need to keep track of captured pieces as these pieces do not appear on the board.</p><figure id="0ef2b113-0ec1-40c0-8ab4-0f5f1f0c9483" class="image"><a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%203.png"><img style="width:3738px" src="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%203.png"/></a></figure><h3 id="641b7c59-d358-4072-b1e3-5a33a19765eb" class="">Castling availability</h3><p id="ce390f94-d68a-4e26-9ab6-903ef74cc663" class="">We need to track if <a href="https://en.wikipedia.org/wiki/Castling">castling</a> is available on the king’s side, on the queen’s side, or both. In particular, castling is not permitted if the king or the rook has previously moved.</p><figure id="95a1c72a-44c1-45fc-8d9f-33d1ec231a11" class="image"><a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%204.png"><img style="width:3738px" src="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%204.png"/></a></figure><h3 id="9ae65854-6f18-4a0a-952d-3eb366c57be9" class="">En passant target</h3><p id="de96ca3e-257e-404f-b8fb-1dd6e78273eb" class="">The <a href="https://en.wikipedia.org/wiki/En_passant">en passant</a> capture is permitted on the turn immediately after the opposing pawn makes the double move. The capturing pawn moves to the square behind the opposing pawn; this square is called the en passant target.</p><figure id="79b59398-35af-4b08-a781-36b7f3466869" class="image"><a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%205.png"><img style="width:3738px" src="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%205.png"/></a></figure><h3 id="cbcb3000-4dc6-40fb-81d2-e482d2a6e17d" class="">Promotions</h3><p id="1b87df5d-8f8f-4b9b-8e01-ead77b48ac3f" class="">A <a href="https://en.wikipedia.org/wiki/Promotion_(chess)">promotion</a> takes place when a pawn makes it to the final rank, and is then replaced with a knight, bishop, rook or queen.</p><figure id="358f1110-9670-4857-b9f6-c0e6b18823b7" class="image"><a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%206.png"><img style="width:3738px" src="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%206.png"/></a></figure><p id="7bcfe881-d86e-461b-a306-c956d2a2a1ce" class="">
</p><p id="7ecfd712-64ee-45f8-9873-ce569611addb" class="">We can track captures with a bitmap of <strong>32 bits</strong>, each bit representing a piece. We can similarly use bitmaps for castling availability and en passant targets with <strong>4</strong> and <strong>16 bits</strong> respectively (1 bit for each rook and 1 bit for each pawn) <a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5.html">[2]</a>.</p><p id="5a159264-56f4-405f-a958-03aa9146b822" class="">
</p><p id="dc32625e-77d6-4590-b33f-3a951f7d28ec" class="">Promotions take a bit more space. For each pawn we need 3 bits: 1 bit for whether or not its been promoted, plus 2 bits for what piece its been promoted to. That’s <strong>48 bits</strong> altogether.</p><p id="b1f4f895-745d-4583-88a4-6837cdaa1e35" class="">
</p><p id="541822da-8db8-4a4d-87af-257c4cccabca" class="">In summary:</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="25d8277f-6278-4efd-a82d-9ca8882a1370"><div style="font-size:1.5em"><span class="icon">🔴</span></div><div style="width:100%">1 bit x 32 (for captures)
+ 1 bit x 4 (for castling)
+ 1 bit x 16 (for en passant)
+ 3 bits x 16 (for promotions)
= 100 bits / <strong>~12 bytes</strong></div></figure><p id="a9c9d310-72f2-4f71-8ee9-85ad3538465e" class="">
</p><p id="7aa29cf0-64bb-4eb0-a089-b3ee61c3063c" class="">Can we do better?</p><h1 id="a4a84fc8-0b42-4d0b-bd46-a79c3a77940b" class="">No two pieces occupy the same square</h1><p id="390c5f29-590b-4717-a0d8-bd0e76ecf2e4" class="">The first observation is that no two pieces can occupy the same square on the board.</p><p id="05910ee3-6686-4f69-a6b9-582f81796bba" class="">
</p><p id="7dc228df-40b3-4cd5-ba0a-11de1d26de51" class="">We can apply this to captures by using the opposing king’s position to represent the capture of that piece.</p><figure id="c3b9ddf5-956e-4ace-8407-8f680e12c8cf" class="image"><a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%207.png"><img style="width:3738px" src="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%207.png"/></a></figure><p id="01cb0f36-7e46-4213-81ac-5bee17bdbb78" class="">
</p><p id="2481c6ab-2aff-4ddd-90c2-9f4e7730959a" class=""><a href="https://github.com/cthulahoops">Adam Kelly</a> noted how we can take this further by using our own king’s position. For castling, we simply replace the rook’s position. Since castling is available only if the rook has not moved, we know that the rook would be at its original position.</p><figure id="f67bf2f9-d2e5-4d3b-82c1-4783154cf02c" class="image"><a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%208.png"><img style="width:3738px" src="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%208.png"/></a></figure><p id="f4fbaf90-3f0f-44cd-ae3b-6c41aa7742af" class="">
</p><p id="d8fdb8be-6edd-496f-a9a6-1c1115a73577" class="">For en passant, we know that the pawn that just made the double move is at its home file and at a specific rank (4 for white or 5 for black). We similarly replace the pawn’s position with our own king’s position.</p><figure id="739ada17-2c67-4f14-82a8-e70c954abf94" class="image"><a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%209.png"><img style="width:3738px" src="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%209.png"/></a></figure><p id="8e77267f-8506-48fd-8ce4-9610e0e91f3f" class="">
</p><p id="e98ce6f3-05fd-4bd3-8f9f-074febd1818c" class="">By using this trick, we can store captures, castling availability and the en passant target for free!</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="2da99c2c-067a-4799-bf8a-bf176fce2d0d"><div style="font-size:1.5em"><span class="icon">🟡</span></div><div style="width:100%"><em><mark class="highlight-red">free!</mark></em> (for captures)
+ <em><mark class="highlight-red">free!</mark></em> (for castling)
+ <em><mark class="highlight-red">free!</mark></em> (for en passant)
+ 3 bits x 16 (for promotions)
= 48 bits / <strong>6 bytes</strong></div></figure><p id="bc4eb441-7f76-446e-974a-c1b3fd68f393" class="">
</p><p id="2d70dacc-a5ad-4e8d-b073-cb92251efcb0" class="">Let’s take a closer look at promotions.</p><h1 id="db339ac2-1a58-4866-9996-8a17e1317f32" class="">Ordering of promotions can be unique</h1><p id="949cc4a0-171a-4c44-8e8f-a88d4fda9e53" class="">The second observation is that the ordering of promoted pawns can be made unique.</p><p id="5ca5c6bf-6755-4235-b710-85901491df4e" class="">
</p><p id="8f35c525-c450-45e7-a153-ce5b99e0f1fc" class="">In this illustrative example, one pawn is promoted to a queen and another to a rook. The top line on the right represents white pawn positions, while the bottom lines represent the promotion encoding (3 bits for each white pawn) <a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5.html">[3]</a>.</p><figure id="014c87ce-39ea-49da-8cfd-2aad6579f751" class="image"><a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%2010.png"><img style="width:3738px" src="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%2010.png"/></a></figure><p id="24e9e2bb-4add-4119-af33-0d3fa35f18aa" class="">
</p><p id="ee1ea265-1591-422e-95d5-6b70e97252aa" class="">Now let’s do the following:</p><ol type="1" id="4c36efd3-c22b-4caa-ae23-089401e6e8c9" class="numbered-list" start="1"><li>Represent non-promoted pawns by <code>0</code> and the promoted pawns by <code>1</code> to <code>4</code>.</li></ol><ol type="1" id="60478c87-bf3e-4ade-9839-84c11363b40f" class="numbered-list" start="2"><li>Sort the representation in ascending order and reorder the positions accordingly <a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5.html">[4]</a>.</li></ol><figure id="230a8894-4bc7-4906-8476-2875b43ed347" class="image"><a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%2011.png"><img style="width:3738px" src="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5/Untitled%2011.png"/></a></figure><p id="051dde1b-5239-40b4-ad4d-d3ff54ee115c" class="">
</p><p id="d9e993ee-f587-4a1b-b651-804743757d19" class="">This gives us the string <code>00000034</code> to uniquely represent this specific set of promotions, without information loss.</p><p id="43a9d5db-8885-4960-9009-fedbf1929655" class="">
</p><p id="8c769b00-f69f-4ec2-b034-f126240a5bb9" class="">How many possible strings are there? Generating this by brute force, we end up with 495 distinct strings <a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5.html">[5]</a>. </p><pre id="dfedee2f-323f-4f9d-b093-b575b71ca99f" class="code"><code>len(
    set(
        [
            tuple(sorted((a, b, c, d, e, f, g, h)))
            for a in [0, 1, 2, 3, 4]
            for b in [0, 1, 2, 3, 4]
            for c in [0, 1, 2, 3, 4]
            for d in [0, 1, 2, 3, 4]
            for e in [0, 1, 2, 3, 4]
            for f in [0, 1, 2, 3, 4]
            for g in [0, 1, 2, 3, 4]
            for h in [0, 1, 2, 3, 4]
        ]
    )
)</code></pre><p id="5d3dd39d-3843-40ec-948e-c38082b90dfa" class="">
</p><p id="2c02588e-4e09-41da-8b9b-5686dc036146" class="">This can be stored in <strong>9 bits</strong> for each side <a href="Bitpacking%20chess%20positions%20f184ef04828846a19b736d08131656c5.html">[6]</a>.</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="e9586a69-3316-4cb6-b354-70d2015b37fe"><div style="font-size:1.5em"><span class="icon">🟢</span></div><div style="width:100%"><em>free!</em> (for captures)
+ <em>free!</em> (for castling)
+ <em>free!</em> (for en passant)
+ <mark class="highlight-red">9 bits x 2</mark> (for promotions)
= 18 bits / <strong>~2 bytes</strong></div></figure><p id="209d28fb-a1ff-4bbf-a8ee-406b69961661" class="">
</p><p id="38fa9a81-da5c-4aee-ac5a-170093988c58" class="">We add this to the 24 bytes for positions and end up with a total of <strong>~26 bytes</strong>!</p><h1 id="8e5bde15-353f-4a42-880c-50fcd9b1b78c" class="">Next steps</h1><p id="7c354a64-9e7e-4b9c-9b32-d5194ce4862e" class="">Feel free to try this out on Replit <a href="https://replit.com/@savarin/bitpacker?v=1">here</a>! The code can be found on Github <a href="https://github.com/savarin/bitpacker">here</a>.</p><p id="9378ee45-5f0a-46e4-9f45-5932aeb93dee" class="">
</p><p id="42ad39bd-6bca-4e2c-a2d7-d78aad48be23" class="">Chess encoding (and compression in general!) is a deep and fascinating topic. This <a href="https://lichess.org/blog/Wqa7GiAAAOIpBLoY/developer-update-275-improved-game-compression">post</a> discusses the use of <a href="https://en.wikipedia.org/wiki/Huffman_coding">Huffman coding</a> to efficiently store chess games.</p><p id="56c825c7-0250-486d-8196-922ce1f53af2" class="">
</p><p id="3bc4435b-788e-405c-a38d-ec2e5868a74c" class="">If this sounds like fun, you should apply to Recurse Center! The <a href="https://www.recurse.com/faq#:~:text=The%20next%20batch%20starts%20on%20Tuesday%2C%20January%203rd%2C%202023">next batch</a> starts on Jan 3 2023, with an <a href="https://www.recurse.com/events/rc-december-info-session">information session</a> on Dec 9 2022.</p><p id="8a7d3c8e-4b2c-4937-ad16-2b58b033e1c4" class="">
</p><p id="c027bc4c-9beb-4145-9f76-41012df3ffed" class="">If you’re curious about my take, I’m reachable <a href="https://airtable.com/shrqMzRrrdIWkv0fg">here</a>. Other RC posts can be found <a href="Rewriting%20my%20toy%20blockchain%20in%20Rust%209a130f225666488491ba497004821fbb.html">here</a> and <a href="https://payments.posthaven.com">here</a>.</p><h1 id="5ab083f4-1a76-4502-9048-5e1521e884e2" class="">Appendix</h1><p id="7356c7bb-1b8d-4593-ae18-f416abfbcc68" class=""><strong>[1]</strong> The <a href="https://en.wikipedia.org/wiki/Forsyth%E2%80%93Edwards_Notation">Forsyth-Edwards Notation</a> stores the positions, active color, castling availability, target square, the half-move clock and full-move number.</p><p id="d47be6dd-40b3-4b57-8533-6815eb015414" class="">
</p><p id="60d64008-68d0-495a-9418-5eaaceb0e3dc" class=""><strong>[2]</strong> Since at most 1 pawn is available for en passant capture, we can actually make this more compact. We need 1 bit for whether or not it’s available, plus 4 bits to represent 16 pawns, for a total of 5 bits.</p><p id="6887c667-7e17-40a8-9f48-61057b94b546" class="">
</p><p id="0aa8a403-8a77-473f-992c-6fcf92faeaa9" class=""><strong>[3]</strong> We use <code>n</code>, <code>b</code>, <code>r</code> and <code>q</code> to represent the promotions to knight, bishop, rook and queen respectively. This is purposely chosen, as a contrast to the <code>0</code> - <code>4</code> representation that follows.</p><p id="68930d89-60d0-4c79-80a4-fca249ce0c0c" class="">
</p><p id="dcfd7113-d9dc-42a2-bfc5-dfe9162b52ce" class=""><strong>[4]</strong> For en passant we need the pawn to remain on its home file. Hence we exclude the pawn from this step if it can be captured en passant. Captures can appear on any file.</p><p id="3149a445-da4a-4d2f-971f-7e30ae433cc4" class="">
</p><p id="d830568e-3c5d-4f79-8007-809395d6526e" class=""><strong>[5]</strong> <a href="https://github.com/bzinberg">Ben Zinberg</a> uses a balls-and-urns argument to come up with 495.</p><blockquote id="505a9c39-8710-4608-92c7-8eec57d3ba16" class="">For each string of 0s, 1s and 2s having length 3 in weakly ascending order as you describe, you can imagine writing the string on 5 blank spaces, where there is a ‘divider’ space any time the digit changes. For example, the string <code>012</code> would be written <code>0 _ 1 _ 2</code> where the <code>_</code>s are divider spaces. The string <code>000</code> would be written <code>0 0 0 _ _</code> with a string of zero 1s after the first divider and a string of zero 2s after the second divider.

The digits to write on the non-divider spaces are uniquely determined by where you place the dividers. Thus, the strings you describe are in one-to-one correspondence with choices of how to place the 2 dividers, and the number of ways to do that is the <a href="https://en.wikipedia.org/wiki/Binomial_coefficient">binomial coefficient</a> <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mn>5</mn><mn>2</mn></mfrac><mo fence="true">)</mo></mrow><mo stretchy="false">(</mo><mn>25</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\binom{5}{2}(25)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.245118em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8951079999999999em;"><span style="top:-2.3550000000000004em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.144em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mopen">(</span><span class="mord">25</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>.

This argument generalizes to say, the number of weakly-ascending sequences of integers in <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{ 0, \ldots, k - 1 \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span></span><span>﻿</span></span> having length <em><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span></span><span>﻿</span></span></em> is equal to the number of ways to place <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span><span>﻿</span></span> divider spaces among <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n + k - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span><span>﻿</span></span> blank spaces, which is equal to <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mrow><mi>n</mi><mo>+</mo><mi>k</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\binom{n + k - 1}{k - 1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3334389999999998em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9301079999999999em;"><span style="top:-2.355em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.144em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span><span>﻿</span></span>.</blockquote><p id="f908f24a-f7b2-4fcf-a267-ea86a3d27090" class="">
</p><p id="9ff93875-81b9-4bfe-b8c7-488dbc9e8c4e" class=""><strong>[6]</strong> With a limit of 8 bits for each side, we can fully track at most 4 promoted pawns. Alternatively we note that promotions always involve a capture; we can potentially reclaim 1 bit by convention of denoting captures either left-most or right-most.</p><p id="062f2937-a1d8-4a71-a2ef-d609f30cdf65" class="">
</p></div></article></body></html>